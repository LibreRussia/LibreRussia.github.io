:title: LibreOffice Calc: Импорт таблицы с сайта
:date: 27.09.2014 11:00:00
:category: Calc
:tags: LibreOffice, Calc

Сейчас дописываю свой диплом и мне понадобилось произвести некоторые расчеты на основании оборотной ведомости по счетам бухгалтерского учета кредитной организации (`пример <http://www.cbr.ru/credit/101.asp?regnum=705&when=0&dt=20120101>`_). Как видно, это огромная таблица, состоящая из множества счетов.

Для расчета мне нужны только отдельные строки (счета второго порядка) этой ведомости. Каждый счет имеет свой номер. Мне надо:

* Найти отдельные счета
* Узнать суммы на них
* Произвести расчет

Для этой цели необходимо использовать поиск и электронные таблицы. Но делать поиск по странице в браузере не очень удобно, т.к. надо искать номера только в первом столбце, а похожие числа встречаются и в других. Да и что делать потом с найденными счетами? Копировать каждое число в Calc?

Нет. Все гораздо проще.

LibreOffice поддерживает импорт html документов. Я и воспользовался этой функцией.

Сначала я сохранил страницу с оборотной ведомостью на компьютер. Нажал в браузере правую кнопку мыши и выбрал в контекстном меню пункт *«Сохранить как»* (``Ctrl + S``).

.. |center| raw:: html

   <center>
   
.. |/center| raw:: html

   </center>

|center|

.. figure:: img/lo-calc/lo-calc-import-tablici-001.png
       :width: 450 px
       :align: center
       :alt:  

|/center|
    
Открыл LibreOffice Calc и выполнил *«Файл → Открыть»* (``Ctrl + O``). В окне выбора файлов выбрал сохраненную страницу, она имеет расширение «``.html``». С помощью выпадающего меню можно отфильтровать файлы по расширению.

|center|

.. figure:: img/lo-calc/lo-calc-import-tablici-002.png
       :width: 450 px
       :align: center
       :alt:  

|/center|

Импорт был благополучно совершен.

|center|

.. figure:: img/lo-calc/lo-calc-import-tablici-003.png
       :width: 450 px
       :align: center
       :alt:  
  
|/center|       

Теперь я могу пользоваться всеми преимуществами LibreOffice.

P.S. Результат импорта зависит от структуры сайта.

Ссылки по теме
--------------

* `Краткое руководство по LibreOffice: Глава 5 – Табличный процессор Calc <http://libreoffice.readthedocs.org/ru>`_
* `Поиск и возврат значений (функции VLOOKUP и IFERROR) <http://librerussia.blogspot.ru/2014/10/libreoffice-calc-vlookup-iferror.html>`_
* `Импорт xml-файлов <http://librerussia.blogspot.ru/2014/12/libreoffice-calc-xml.html>`_